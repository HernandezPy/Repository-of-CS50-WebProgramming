{% extends "auctions/layout.html" %}


{% block body %}
<div class="container mt-3">

    <h2>{{ listing.title }}</h2>

    <div class="row mb-3">
        <div class="col-md-4">
            <img src="{{ listing.image_url }}" class="img-fluid rounded" alt="{{ listing.title }}">
        </div>
        <div class="col-md-8">
            <p>{{ listing.description }}</p>
            <p>Price: ${{ listing.price }}</p>
            <p>Created {{ listing.created_listing|date:"M. d, Y, g:i a" }}</p>

            {% if user.is_authenticated %}
                <!-- Watchlist Button -->
                <form action="{% url 'toggle_watchlist' listing.id %}" method="post">
                    {% csrf_token %}
                    <button class="btn {% if is_watching %}btn-danger{% else %}btn-success{% endif %}">
                        {% if is_watching %}
                            Remove from Watchlist
                        {% else %}
                            Add to Watchlist
                        {% endif %}
                    </button>
                </form>
            {% endif %}

            <!-- Winner display -->
            {% if winner %}
                <p class="mt-2"><strong>Winner:</strong> {{ winner.username }}</p>
            {% elif not listing.active %}
                <p class="mt-2"><strong>This listing is closed.</strong></p>
            {% endif %}

            <!-- Placeholder for Bids -->
            {% if listing.active %}
                <form action="{% url 'place_bid' listing_id=listing.id %}" method="post" class="mt-3">
                    {% csrf_token %}
                    <input type="number" name="bid_amount" placeholder="Your bid" class="form-control mb-2">
                    <button class="btn btn-primary">Place Bid</button>
                </form>
            {% endif %}

        </div>
    </div>
</div>


{% endblock %}
